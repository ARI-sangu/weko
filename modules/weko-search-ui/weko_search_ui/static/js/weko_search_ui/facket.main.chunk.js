(this["webpackJsonpweko-facet-search"]=this["webpackJsonpweko-facet-search"]||[]).push([[0],{69:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),s=a(10),i=a.n(s),r=a(36),l=a(37),o=a(13),h=a(42),u=a(41),d=(a(17),a(18),a(28)),b=a(16),g=a(71),f=a(40),p=a(4);var j=function(e){var t=e.value,a=e.name,n=e.labels,c=window.location.search.replace(",","%2C")||"?",s=[],i=[];return t&&t.map((function(e,t){var r={label:"",value:""},l=encodeURIComponent(a)+"="+encodeURIComponent(e.key),o=c.indexOf(l+"&")>=0,h=c.endsWith(l);r.label=(n[e.key]||e.key)+"("+e.doc_count+")",r.value=e.key,i.push(r),(o||h)&&s.push(r)})),Object(p.jsx)("div",{children:Object(p.jsx)("div",{className:"select-container",children:Object(p.jsx)(f.a,{defaultValue:s,isMulti:!0,name:"Facet_Search",ontrolShouldRenderValue:!1,onChange:function(e){!function(e){var t="";if(c.indexOf("&")>=0){for(var n=c.split("&"),s=0;s<n.length;s++)n[s].indexOf(encodeURIComponent(a)+"=")<0&&(t+="&"+n[s]);t=t.substring(1)}""!=t&&(c=t),e.map((function(e,t){var n=encodeURIComponent(a)+"="+encodeURIComponent(e.value);c+="&"+n})),window.location.href="/search"+c}(e)},backspaceRemovesValue:!1,isClearable:!1,options:i,className:"basic-multi-select",classNamePrefix:"select"})})})};a(39);for(var v=function(e){var t=e.item,a=e.nameshow,c=e.name,s=e.key,i=e.labels,r=window.location.search.replace(",","%2C").indexOf(encodeURIComponent(c))>=0,l=Object(n.useState)(r),o=Object(b.a)(l,2),h=o[0],u=o[1];return Object(p.jsxs)("div",{className:"panel panel-default",children:[Object(p.jsxs)("div",{className:"panel-heading clearfix",children:[Object(p.jsx)("h3",{className:"panel-title pull-left",children:a}),Object(p.jsxs)("a",{className:"pull-right",onClick:function(){return u(!h)},children:[!h&&Object(p.jsx)("span",{children:Object(p.jsx)("i",{className:"glyphicon glyphicon-chevron-right"})}),h&&Object(p.jsx)("span",{children:Object(p.jsx)("i",{className:"glyphicon glyphicon-chevron-down"})})]})]}),Object(p.jsx)(g.a,{isOpen:h,children:Object(p.jsxs)("div",{className:"panel-body index-body",children:[Object(p.jsx)(j,{value:t.buckets,name:c,labels:i}),!1]})})]},s)},k={},m=document.getElementsByClassName("body-facet-search-label"),O=0;O<m.length;O++)k[m[O].id]=m[O].value;var y=function(e){Object(h.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).state={is_enable:!0,list_title:{},list_facet:{}},n.getTitle=n.getTitle.bind(Object(o.a)(n)),n.get_facet_search_list=n.get_facet_search_list.bind(Object(o.a)(n)),n.convertData=n.convertData.bind(Object(o.a)(n)),n.getUrlVars=n.getUrlVars.bind(Object(o.a)(n)),n}return Object(l.a)(a,[{key:"getTitle",value:function(){var e=this,t={};Object(d.a)("/facet-search/get-title",{method:"POST"}).then((function(e){return e.json()})).then((function(a){a.status&&(t=a.data),e.setState({list_title:t})}))}},{key:"get_facet_search_list",value:function(){var e=this,t=window.location.search,a="/api/records/",n=this.getUrlVars();n.search_type&&"2"===String(n.search_type)&&(a="/api/index/"),Object(d.a)(a+t).then((function(e){return e.json()})).then((function(t){if(n.search_type&&"2"===String(n.search_type)){var a=t&&t.aggregations&&t.aggregations.path&&t.aggregations.path.buckets&&t.aggregations.path.buckets[0]?t.aggregations.path.buckets[0]:{};e.convertData(a&&a[0]?a[0]:{})}else e.convertData(t&&t.aggregations?t.aggregations:{})}))}},{key:"getUrlVars",value:function(){var e={};return window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(t,a,n){e[a]=n})),e}},{key:"convertData",value:function(e){var t={};e&&Object.keys(e).map((function(a,n){var c=e[a][a]?e[a][a]:e[a],s=c.key&&c.key.hasOwnProperty("buckets");if(s=c.hasOwnProperty("buckets")||s){if(t[a]=c[a]?c[a]:c,"Temporal"!=a&&"Data Language"!=a&&"Access"!=a)for(var i=document.getElementById("lang-code"),r=i.options[i.selectedIndex].value,l=t[a],o=0;o<l.buckets.length;o++){var h=l.buckets[o];("en"==r&&(h.key.charCodeAt(0)>256||h.key.charCodeAt(h.key.length-1)>256)||"en"!=r&&h.key.charCodeAt(0)<256&&h.key.charCodeAt(h.key.length-1)<256)&&delete t[a].buckets[o]}if("Access"==a)for(var u=t[a],d=0;d<u.buckets.length;d++){var b=u.buckets[d];(b.key.charCodeAt(0)>256||b.key.charCodeAt(b.key.length-1)>256)&&delete t[a].buckets[d]}}})),this.setState({list_facet:t})}},{key:"componentDidMount",value:function(){this.getTitle(),this.get_facet_search_list()}},{key:"render",value:function(){var e=this.state,t=e.is_enable,a=e.list_title,n=e.list_facet;return Object(p.jsx)("div",{children:t&&Object(p.jsx)("div",{className:"facet-search break-word",children:Object.keys(n).map((function(e,t){var c=n[e],s=a[e];return Object(p.jsx)(v,{item:c,nameshow:s,name:e,labels:k},t)}))})})}}]),a}(c.a.Component);i.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(y,{})}),document.getElementById("app-facet-search"))}},[[69,1,2]]]);
//# sourceMappingURL=main.ea7af7ac.chunk.js.map