(this["webpackJsonpweko-facet-search"]=this["webpackJsonpweko-facet-search"]||[]).push([[0],{45:function(e,t,a){},71:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),l=a(13),s=a.n(l),r=a(8),o=a(9),i=a(4),d=a(10),u=a(14),h=(a(17),a(18),a(45),a(29)),m=a(6),b=a(73),v=a(40),p=a(3);var g=function(e){for(var t=e.values,a=e.name,n=e.labels,c=window.location.search.replace(",","%2C")||"?",l=window.location.search.substring(1).split("&"),s=0;s<l.length;s++)l[s]=decodeURIComponent(l[s]);var r=[],o=[];return t&&t.map((function(e,t){var c={label:(n[e.key]||e.key)+"("+e.doc_count+")",value:e.key};o.push(c);var s=a+"="+e.key;-1!=l.indexOf(s)&&r.push(c)})),Object(p.jsx)("div",{children:Object(p.jsx)("div",{className:"select-container",children:Object(p.jsx)(v.a,{defaultValue:r,isMulti:!0,name:"Facet_Search",ontrolShouldRenderValue:!1,onChange:function(e){!function(e){var t="";if(c.indexOf("&")>=0){for(var n=c.split("&"),l=0;l<n.length;l++)n[l].indexOf(encodeURIComponent(a)+"=")<0&&(t+="&"+n[l]);t=t.substring(1)}""!=t&&(c=t),e.map((function(e,t){var n=encodeURIComponent(a)+"="+encodeURIComponent(e.value);c+="&"+n})),c=c.replace("q=0","q="),c+=-1==c.indexOf("is_facet_search=")?"&is_facet_search=true":"",window.location.href="/search"+c}(e)},backspaceRemovesValue:!1,isClearable:!1,options:o,className:"basic-multi-select",classNamePrefix:"select"})})})},j=a(39);var f=function(e){var t=e.value,a=e.name,c=(e.labels,"id_"+a+"_slider");CSS.escape(c);var l=window.location.search.replace(",","%2C")||"?",s=new URL(document.location).searchParams,r=null==s.get("date_range1_from")?null:parseInt(s.get("date_range1_from")),o=null==s.get("date_range1_to")?null:parseInt(s.get("date_range1_to"));t&&null==r&&null==o&&t.map((function(e,t){var a;e.key.length>0&&(a=parseInt(e.key),(null==r||r>a)&&(r=a),(null==o||o<a)&&(o=a))}));var i=(o-r)/100,d=Object(n.useState)(r),u=Object(m.a)(d,2),h=u[0],b=u[1],v=Object(n.useState)(o),g=Object(m.a)(v,2),f=g[0],O=g[1];return Object(p.jsxs)("div",{id:c,children:[Object(p.jsx)("div",{className:"col-sm-11",style:{paddingBottom:"20px","white-space":"nowrap"},children:Object(p.jsx)(j.a.Range,{min:r,max:o,step:i,onChange:function(e){h!=e[0]&&b(Math.round(e[0])),f!=e[1]&&O(Math.round(e[1]))},defaultValue:[r,o]})}),Object(p.jsxs)("div",{className:"form-group row",children:[Object(p.jsx)("div",{className:"col-sm-5",children:Object(p.jsx)("input",{type:"number",id:c+"_input_head",className:"form-control",value:h,onChange:function(e){return b(e.target.value)}})}),Object(p.jsx)("div",{className:"col-sm-5",children:Object(p.jsx)("input",{type:"number",id:c+"_input_tail",className:"form-control",value:f,onChange:function(e){return O(e.target.value)}})}),Object(p.jsx)("div",{className:"col-sm-2",children:Object(p.jsx)("button",{type:"button",style:{marginLeft:"3px"},className:"btn btn-primary pull-right",onClick:function(){if(function(){var e="";if(l.indexOf("&")>=0){var t=l.split("&");console.log(t);for(var a=0;a<t.length;a++)t[a].indexOf(encodeURIComponent("date_range1_from")+"=")<0&&t[a].indexOf(encodeURIComponent("date_range1_to")+"=")<0&&(e+="&"+t[a]);e=e.substring(1)}""!=e&&(l=e)}(),function(){var e=document.getElementById(c+"_input_head"),t=document.getElementById(c+"_input_tail"),a=document.getElementById(c+"_msg");if(e.classList.remove("range-slider-error"),t.classList.remove("range-slider-error"),a.textContent="",console.log("====== SLIEDER DEBUG   START ======"),console.log("headComp.value:"+e.value),console.log("tailComp.value:"+t.value),console.log("headComp.value-bool:"+!e.value),console.log("tailComp.value-bool:"+!t.value),!e.value||!t.value)return e.value||e.classList.add("range-slider-error"),t.value||t.classList.add("range-slider-error"),a.textContent="Set the value.",!1;var n=new RegExp(/^([1-9]\d*|0)$/),l=n.exec(h),s=n.exec(f);return null==l||l[0]!=h||null==s||s[0]!=f?(null!=l&&l[0]==h||e.classList.add("range-slider-error"),null!=s&&s[0]==f||t.classList.add("range-slider-error"),a.textContent="Set the correct value.",!1):!(parseFloat(h)>parseFloat(f))||(e.classList.add("range-slider-error"),t.classList.add("range-slider-error"),a.textContent="The range from should be less than or equal to the range to.",!1)}()){var e="";e+="&"+encodeURIComponent("date_range1_from")+"="+encodeURIComponent(h),e+="&"+encodeURIComponent("date_range1_to")+"="+encodeURIComponent(f),l+=e,window.location.href="/search"+l}},children:" \u691c\u7d22"})})]}),Object(p.jsx)("div",{className:"range-slider-error-msg",id:c+"_msg"})]})};var O=function(e){var t=e.values,a=e.name,n=e.labels,c=e.displayNumber,l="id_"+a+"_chkbox",s=CSS.escape(l),r=function(e){var t=e.id,a=e.value,n=e.checked,c=e.onChange;return null!=c?Object(p.jsx)("input",{id:t,className:"facet-chbox",type:"checkbox",checked:n,onChange:c,value:a}):Object(p.jsx)("input",{id:t,className:"facet-chbox",type:"checkbox",defaultChecked:n,value:a})},o=function(e){var t=e.values,a=e.name,n=e.isModal,c=e.displayNumber,l=e.onChange;return t.map((function(e,t){if(n||t<c){var s="id_"+a+(n?"_chkbox_mdl_":"_chkbox_")+t,o=e.key+"("+e.doc_count+")",i=-1!=b.indexOf(a+"="+e.key);return Object(p.jsx)("div",{children:Object(p.jsxs)("label",{htmlFor:s,children:[Object(p.jsx)(r,{id:s,value:e.key,checked:i,onChange:l},s),o]})},s)}}))},i=function(e){var t=e.values,a=e.name,c=e.modalId;return Object(p.jsxs)("div",{className:"chbox-mdl",id:c,children:[Object(p.jsx)("a",{href:"#!",className:"overlay",onClick:d,modalId:c}),Object(p.jsx)("div",{className:"window",children:Object(p.jsxs)("div",{className:"content",children:[Object(p.jsx)("div",{className:"list",children:Object(p.jsx)(o,{values:t,name:a,isModal:!0})}),Object(p.jsxs)("div",{className:"footer",children:[Object(p.jsx)("a",{href:"#!",onClick:d,modalId:c,children:n.cancel}),Object(p.jsx)("button",{type:"button",className:"btn btn-primary",onClick:u,children:n.search})]})]})})]},c)};function d(e){null!=e&&document.getElementById(e.target.getAttribute("modalId")).classList.remove("is-active")}function u(e){var t=[];document.querySelector("#"+s).querySelectorAll(".chbox-mdl input").forEach((function(e){e.checked&&t.push({label:a,value:e.value})})),h(t)}function h(e){var t="";if(m.indexOf("&")>=0){for(var n=m.split("&"),c=0;c<n.length;c++)n[c].indexOf(encodeURIComponent(a)+"=")<0&&(t+="&"+n[c]);t=t.substring(1)}""!=t&&(m=t),e.map((function(e,t){var n=encodeURIComponent(a)+"="+encodeURIComponent(e.value);m+="&"+n})),m=m.replace("q=0","q="),m+=-1==m.indexOf("is_facet_search=")?"&is_facet_search=true":"",window.location.href="/search"+m}for(var m=window.location.search.replace(",","%2C")||"?",b=window.location.search.substring(1).split("&"),v=0;v<b.length;v++)b[v]=decodeURIComponent(b[v]);var g="id_"+a+"_checkbox_modal",j=null==c?5:c;return Object(p.jsx)("div",{id:l,children:Object(p.jsxs)("div",{className:"chbox-container",children:[Object(p.jsx)(o,{values:t,name:a,isModal:!1,displayNumber:j,onChange:function(e){var t=[];document.querySelector("#"+s).querySelectorAll(".chbox-mdl input").forEach((function(n){(n.checked&&e.target.value!==n.value||e.target.checked&&e.target.value===n.value)&&t.push({label:a,value:n.value})})),h(t)}}),t.length>j&&Object(p.jsx)("a",{href:"#"+g,onClick:function(e){null!=e?(document.getElementById(e.target.getAttribute("modalId")).classList.add("is-active"),document.querySelector("#"+s).querySelectorAll(".chbox-mdl input").forEach((function(e){e.checked=-1!=b.indexOf(a+"="+e.value)}))):console.log("event == null")},modalId:g,children:". . . See More"}),Object(p.jsx)(i,{values:t,name:a,modalId:g,displayNumber:c})]})})};for(var x=function(e){var t=e.item,a=e.nameshow,c=e.name,l=e.key,s=e.labels,r=e.isInitOpen,o=e.uiType,i=e.displayNumber,d=window.location.search.replace(",","%2C").indexOf(encodeURIComponent(c))>=0||r,u=Object(n.useState)(d),h=Object(m.a)(u,2),v=h[0],j=h[1];return Object(p.jsxs)("div",{className:"panel panel-default",children:[Object(p.jsxs)("div",{className:"panel-heading clearfix",children:[Object(p.jsx)("h3",{className:"panel-title pull-left",children:a}),Object(p.jsxs)("a",{className:"pull-right",onClick:function(){return j(!v)},children:[!v&&Object(p.jsx)("span",{children:Object(p.jsx)("i",{className:"glyphicon glyphicon-chevron-right"})}),v&&Object(p.jsx)("span",{children:Object(p.jsx)("i",{className:"glyphicon glyphicon-chevron-down"})})]})]}),Object(p.jsx)(b.a,{isOpen:v,children:Object(p.jsxs)("div",{className:"panel-body index-body",children:[null!=t&&"SelectBox"===o&&Object(p.jsx)(g,{values:t.buckets,name:c,labels:s}),null!=t&&"CheckboxList"===o&&Object(p.jsx)(O,{values:t.buckets,name:c,labels:s,displayNumber:i}),null!=t&&"RangeSlider"===o&&Object(p.jsx)(f,{value:t.buckets,name:c,labels:s})]})})]},l)},_={},y=document.getElementsByClassName("body-facet-search-label"),k=0;k<y.length;k++)_[y[k].id]=y[k].value;var C=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).state={is_enable:!1,list_title:{},list_facet:{},list_order:{},list_uiType:{},list_isOpen:{},list_displayNumber:{}},n.getTitleAndOrder=n.getTitleAndOrder.bind(Object(i.a)(n)),n.get_facet_search_list=n.get_facet_search_list.bind(Object(i.a)(n)),n.convertData=n.convertData.bind(Object(i.a)(n)),n}return Object(o.a)(a,[{key:"getTitleAndOrder",value:function(){var e=this,t={},a={},n={},c={},l={};Object(h.a)("/facet-search/get-title-and-order",{method:"POST"}).then((function(e){return e.json()})).then((function(s){s.status&&(t=s.data.titles,a=s.data.order,n=s.data.uiTypes,c=s.data.isOpens,l=s.data.displayNumbers),e.setState({list_title:t}),e.setState({list_order:a}),e.setState({list_uiType:n}),e.setState({list_isOpen:c}),e.setState({list_displayNumber:l}),e.setState({is_enable:!0})}))}},{key:"get_facet_search_list",value:function(){var e=this,t=new URLSearchParams(window.location.search),a=2==t.get("search_type")?"/api/index/":"/api/records/";Object(h.a)(a+"?"+t.toString()).then((function(e){return e.json()})).then((function(a){if(2==t.get("search_type")){var n=a&&a.aggregations&&a.aggregations.aggregations?a.aggregations.aggregations[0]:{};e.convertData(n)}else e.convertData(a&&a.aggregations?a.aggregations:{})}))}},{key:"convertData",value:function(e){var t={};e&&Object.keys(e).map((function(a,n){var c=e[a][a]?e[a][a]:e[a],l=c.key&&c.key.hasOwnProperty("buckets");if(l=c.hasOwnProperty("buckets")||l){if(t[a]=c[a]?c[a]:c,"Time Period(s)"!=a&&"Data Language"!=a&&"Access"!=a)for(var s=document.getElementById("lang-code"),r=s.options[s.selectedIndex].value,o=t[a],i=0;i<o.buckets.length;i++){var d=o.buckets[i];("en"==r&&(d.key.charCodeAt(0)>256||d.key.charCodeAt(d.key.length-1)>256)||"en"!=r&&d.key.charCodeAt(0)<256&&d.key.charCodeAt(d.key.length-1)<256)&&(t[a].buckets.splice(i,1),i--)}if("Access"==a)for(var u=t[a],h=0;h<u.buckets.length;h++){var m=u.buckets[h];(m.key.charCodeAt(0)>256||m.key.charCodeAt(m.key.length-1)>256)&&(t[a].buckets.splice(h,1),h--)}}})),this.setState({list_facet:t})}},{key:"componentDidMount",value:function(){this.getTitleAndOrder(),this.get_facet_search_list()}},{key:"render",value:function(){var e=this.state,t=e.is_enable,a=e.list_title,n=e.list_facet,c=e.list_order,l=e.list_uiType,s=e.list_isOpen,r=e.list_displayNumber;return Object(p.jsx)("div",{children:t&&Object(p.jsx)("div",{className:"facet-search break-word",children:Object.keys(c).map((function(e,t){var o=c[e],i=n[o],d=a[o],u=s[o],h=l[o],m=r[o];return Object(p.jsx)(x,{item:i,nameshow:d,name:o,labels:_,isInitOpen:u,uiType:h,displayNumber:m},t)}))})})}}]),a}(c.a.Component);s.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(C,{})}),document.getElementById("app-facet-search"))}},[[71,1,2]]]);
//# sourceMappingURL=main.1ea6abbd.chunk.js.map