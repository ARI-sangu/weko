(this["webpackJsonpweko-facet-search"]=this["webpackJsonpweko-facet-search"]||[]).push([[0],{69:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),s=a(10),r=a.n(s),i=a(36),o=a(37),l=a(13),u=a(42),h=a(41),d=(a(17),a(18),a(28)),b=a(16),p=a(71),j=a(40),f=a(4);var g=function(e){var t=e.value,a=e.name,n=e.labels,c=window.location.search.replace(",","%2C")||"?",s=[],r=[];return t&&t.map((function(e,t){var i={label:"",value:""},o=encodeURIComponent(a)+"="+encodeURIComponent(e.key),l=c.indexOf(o+"&")>=0,u=c.endsWith(o);i.label=(n[e.key]||e.key)+"("+e.doc_count+")",i.value=e.key,r.push(i),(l||u)&&s.push(i)})),Object(f.jsx)("div",{children:Object(f.jsx)("div",{className:"select-container",children:Object(f.jsx)(j.a,{defaultValue:s,isMulti:!0,name:"Facet_Search",ontrolShouldRenderValue:!1,onChange:function(e){!function(e){var t="";if(c.indexOf("&")>=0){for(var n=c.split("&"),s=0;s<n.length;s++)n[s].indexOf(encodeURIComponent(a)+"=")<0&&(t+="&"+n[s]);t=t.substring(1)}""!=t&&(c=t),e.map((function(e,t){var n=encodeURIComponent(a)+"="+encodeURIComponent(e.value);c+="&"+n})),window.location.href="/search"+c}(e)},backspaceRemovesValue:!1,isClearable:!1,options:r,className:"basic-multi-select",classNamePrefix:"select"})})})},v=a(39);var m=function(e){var t=e.value,a=e.name,c=e.labels;function s(){var e="";if(u.indexOf("&")>=0){var t=u.split("&");console.log(t);for(var n=0;n<t.length;n++)t[n].indexOf(encodeURIComponent(a)+"=")<0&&(e+="&"+t[n]);e=e.substring(1)}""!=e&&(u=e)}var r,i,o={},l=[],u=window.location.search.replace(",","%2C")||"?";if(t&&t.map((function(e,t){var a;e.key.length>0&&(a=parseInt(e.key),l.push(a))})),l.length>1)for(i in l.sort(),r=100/(l.length-1),l)o[i*r]=l[i].toString();var h=Object(n.useState)(l[0]),d=Object(b.a)(h,2),p=d[0],j=d[1],g=Object(n.useState)(l[i]),m=Object(b.a)(g,2),O=m[0],k=m[1];return Object(f.jsxs)("div",{children:[Object(f.jsx)("div",{className:"col-sm-11",style:{paddingBottom:"20px"},children:Object(f.jsx)(v.a.Range,{min:0,marks:o,step:r,onChange:function(e){s();for(var t=Object.keys(o),n=0;n<t.length;n++)if(t[n]>=e[0]&&t[n]<=e[1]){var c=encodeURIComponent(a)+"="+encodeURIComponent(o[t[n]]);u+="&"+c}window.location.href="/search"+u},defaultValue:[0,100]})}),Object(f.jsxs)("div",{className:"form-group row",children:[Object(f.jsx)("div",{className:"col-sm-5",children:Object(f.jsx)("input",{type:"number",id:"input_head",className:"form-control",value:p,onChange:function(e){return j(e.target.value)}})}),Object(f.jsx)("div",{className:"col-sm-5",children:Object(f.jsx)("input",{type:"number",id:"input_tail",className:"form-control",value:O,onChange:function(e){return k(e.target.value)}})}),Object(f.jsx)("div",{className:"col-sm-2",children:Object(f.jsxs)("button",{type:"button",style:{marginLeft:"3px"},className:"btn btn-primary pull-right",onClick:function(){s();for(var e=[parseInt(p),parseInt(O)],t=Object.values(o),n=0;n<t.length;n++)if(parseInt(t[n])>=e[0]&&parseInt(t[n])<=e[1]){var c=encodeURIComponent(a)+"="+encodeURIComponent(t[n]);u+="&"+c}window.location.href="/search"+u},children:[" ",c.Goto]})})]})]})};function O(e){return"Temporal"===e}for(var k=function(e){var t=e.item,a=e.nameshow,c=e.name,s=e.key,r=e.labels,i=window.location.search.replace(",","%2C").indexOf(encodeURIComponent(c))>=0,o=Object(n.useState)(i),l=Object(b.a)(o,2),u=l[0],h=l[1];return Object(f.jsxs)("div",{className:"panel panel-default",children:[Object(f.jsxs)("div",{className:"panel-heading clearfix",children:[Object(f.jsx)("h3",{className:"panel-title pull-left",children:a}),Object(f.jsxs)("a",{className:"pull-right",onClick:function(){return h(!u)},children:[!u&&Object(f.jsx)("span",{children:Object(f.jsx)("i",{className:"glyphicon glyphicon-chevron-right"})}),u&&Object(f.jsx)("span",{children:Object(f.jsx)("i",{className:"glyphicon glyphicon-chevron-down"})})]})]}),Object(f.jsx)(p.a,{isOpen:u,children:Object(f.jsxs)("div",{className:"panel-body index-body",children:[!O(c)&&Object(f.jsx)(g,{value:t.buckets,name:c,labels:r}),O(c)&&Object(f.jsx)(m,{value:t.buckets,name:c,labels:r})]})})]},s)},y={},x=document.getElementsByClassName("body-facet-search-label"),C=0;C<x.length;C++)y[x[C].id]=x[C].value;var _=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={is_enable:!0,list_title:{},list_facet:{}},n.getTitle=n.getTitle.bind(Object(l.a)(n)),n.get_facet_search_list=n.get_facet_search_list.bind(Object(l.a)(n)),n.convertData=n.convertData.bind(Object(l.a)(n)),n.getUrlVars=n.getUrlVars.bind(Object(l.a)(n)),n}return Object(o.a)(a,[{key:"getTitle",value:function(){var e=this,t={};Object(d.a)("/facet-search/get-title-and-order",{method:"POST"}).then((function(e){return e.json()})).then((function(a){a.status&&(t=a.data.titles),e.setState({list_title:t})}))}},{key:"get_facet_search_list",value:function(){var e=this,t=window.location.search,a="/api/records/",n=this.getUrlVars();n.search_type&&"2"===String(n.search_type)&&(a="/api/index/"),Object(d.a)(a+t).then((function(e){return e.json()})).then((function(t){if(n.search_type&&"2"===String(n.search_type)){var a=t&&t.aggregations&&t.aggregations.path&&t.aggregations.path.buckets&&t.aggregations.path.buckets[0]?t.aggregations.path.buckets[0]:{};e.convertData(a&&a[0]?a[0]:{})}else e.convertData(t&&t.aggregations?t.aggregations:{})}))}},{key:"getUrlVars",value:function(){var e={};return window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(t,a,n){e[a]=n})),e}},{key:"convertData",value:function(e){var t={};e&&Object.keys(e).map((function(a,n){var c=e[a][a]?e[a][a]:e[a],s=c.key&&c.key.hasOwnProperty("buckets");if(s=c.hasOwnProperty("buckets")||s){if(t[a]=c[a]?c[a]:c,"Temporal"!=a&&"Data Language"!=a&&"Access"!=a)for(var r=document.getElementById("lang-code"),i=r.options[r.selectedIndex].value,o=t[a],l=0;l<o.buckets.length;l++){var u=o.buckets[l];("en"==i&&(u.key.charCodeAt(0)>256||u.key.charCodeAt(u.key.length-1)>256)||"en"!=i&&u.key.charCodeAt(0)<256&&u.key.charCodeAt(u.key.length-1)<256)&&delete t[a].buckets[l]}if("Access"==a)for(var h=t[a],d=0;d<h.buckets.length;d++){var b=h.buckets[d];(b.key.charCodeAt(0)>256||b.key.charCodeAt(b.key.length-1)>256)&&delete t[a].buckets[d]}}})),this.setState({list_facet:t})}},{key:"componentDidMount",value:function(){this.getTitle(),this.get_facet_search_list()}},{key:"render",value:function(){var e=this.state,t=e.is_enable,a=e.list_title,n=e.list_facet;return Object(f.jsx)("div",{children:t&&Object(f.jsx)("div",{className:"facet-search break-word",children:Object.keys(n).map((function(e,t){var c=n[e],s=a[e];return Object(f.jsx)(k,{item:c,nameshow:s,name:e,labels:y},t)}))})})}}]),a}(c.a.Component);r.a.render(Object(f.jsx)(c.a.StrictMode,{children:Object(f.jsx)(_,{})}),document.getElementById("app-facet-search"))}},[[69,1,2]]]);
//# sourceMappingURL=main.0e6cfa0e.chunk.js.map