(this["webpackJsonpweko-facet-search"]=this["webpackJsonpweko-facet-search"]||[]).push([[0],{158:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),s=a(12),i=a.n(s),l=a(6),r=a(7),o=a(15),d=a(8),u=a(13),h=(a(19),a(20),a(67),a(38)),b=a(5),m=a(160),p=a(62),f=a(3);var j=function(e){for(var t=e.values,a=e.name,n=e.labels,c=window.location.search.replace(",","%2C")||"?",s=window.location.search.substring(1).split("&"),i=0;i<s.length;i++)s[i]=decodeURIComponent(s[i]);var l=[],r=[];return t&&t.map((function(e,t){var c={label:(n[e.key]||e.key)+"("+e.doc_count+")",value:e.key};r.push(c);var i=a+"="+e.key;-1!=s.indexOf(i)&&l.push(c)})),Object(f.jsx)("div",{children:Object(f.jsx)("div",{className:"select-container",children:Object(f.jsx)(p.a,{defaultValue:l,isMulti:!0,name:"Facet_Search",ontrolShouldRenderValue:!1,onChange:function(e){!function(e){var t="";if(c.indexOf("&")>=0){for(var n=c.split("&"),s=0;s<n.length;s++)n[s].indexOf(encodeURIComponent(a)+"=")<0&&(t+="&"+n[s]);t=t.substring(1)}""!=t&&(c=t),e.map((function(e,t){var n=encodeURIComponent(a)+"="+encodeURIComponent(e.value);c+="&"+n})),c=c.replace("q=0","q="),c+=-1==c.indexOf("is_facet_search=")?"&is_facet_search=true":"",window.location.href="/search"+c}(e)},backspaceRemovesValue:!1,isClearable:!1,options:r,className:"basic-multi-select",classNamePrefix:"select"})})})},v=a(61);var g=function(e){var t=e.value,a=(e.name,e.labels);function c(e){var t=new RegExp(/^(\d{8})|(\d{6})|(\d{4})$/).exec(e),a=!1;return t.length>0&&e==t[0]&&(a=!0),a}var s,i,l={},r=[],o=window.location.search.replace(",","%2C")||"?";if(t&&t.map((function(e,t){var a;e.key.length>0&&(a=parseInt(e.key),r.push(a))})),r.length>1)for(i in r.sort(),s=100/((r=Array.from(new Set(r))).length-1),r)l[i*s]=r[i].toString();var d=Object(n.useState)(r[0]),u=Object(b.a)(d,2),h=u[0],m=u[1],p=Object(n.useState)(r[i]),j=Object(b.a)(p,2),g=j[0],O=j[1];return Object(f.jsxs)("div",{children:[Object(f.jsx)("div",{className:"col-sm-11",style:{paddingBottom:"20px","white-space":"nowrap"},children:Object(f.jsx)(v.a.Range,{min:0,marks:l,step:s,onChange:function(e){m(l[e[0]]),O(l[e[1]])},defaultValue:[0,100]})}),Object(f.jsxs)("div",{className:"form-group row",children:[Object(f.jsx)("div",{className:"col-sm-5",children:Object(f.jsx)("input",{type:"number",id:"input_head",className:"form-control",value:h,onChange:function(e){return m(e.target.value)}})}),Object(f.jsx)("div",{className:"col-sm-5",children:Object(f.jsx)("input",{type:"number",id:"input_tail",className:"form-control",value:g,onChange:function(e){return O(e.target.value)}})}),Object(f.jsx)("div",{className:"col-sm-2",children:Object(f.jsxs)("button",{type:"button",style:{marginLeft:"3px"},className:"btn btn-primary pull-right",onClick:function(){!function(){var e="";if(o.indexOf("&")>=0){var t=o.split("&");console.log(t);for(var a=0;a<t.length;a++)t[a].indexOf(encodeURIComponent("date_range1_from")+"=")<0&&t[a].indexOf(encodeURIComponent("date_range1_to")+"=")<0&&(e+="&"+t[a]);e=e.substring(1)}""!=e&&(o=e)}();var e=parseInt(h),t=parseInt(g),a="";e&&c(e)&&(a+="&"+encodeURIComponent("date_range1_from")+"="+encodeURIComponent(e)),t&&c(t)&&(a+="&"+encodeURIComponent("date_range1_to")+"="+encodeURIComponent(t)),a&&(o+=a,window.location.href="/search"+o)},children:[" ",a.Goto]})})]})]})};var O=function(e){var t=e.values,a=e.name,n=e.labels,c=e.displayNumber,s=function(e){var t=e.id,a=e.value,n=e.checked,c=e.onChange;return null!=c?Object(f.jsx)("input",{id:t,className:"facet-chbox",type:"checkbox",checked:n,onChange:c,value:a}):Object(f.jsx)("input",{id:t,className:"facet-chbox",type:"checkbox",defaultChecked:n,value:a})},i=function(e){var t=e.values,a=e.name,n=e.isModal,c=e.displayNumber,i=e.onChange;return t.map((function(e,t){if(n||t<c){var l="id_"+a+(n?"_chkbox_mdl_":"_chkbox_")+t,r=e.key+"("+e.doc_count+")",o=-1!=b.indexOf(a+"="+e.key);return Object(f.jsx)("div",{children:Object(f.jsxs)("label",{htmlFor:l,children:[Object(f.jsx)(s,{id:l,value:e.key,checked:o,onChange:i},l),r]})},l)}}))},l=function(e){var t=e.values,a=e.name,c=e.modalId;return Object(f.jsxs)("div",{className:"chbox-mdl",id:c,children:[Object(f.jsx)("a",{href:"#!",className:"overlay",onClick:o}),Object(f.jsx)("div",{className:"window",children:Object(f.jsxs)("div",{className:"content",children:[Object(f.jsx)("div",{className:"list",children:Object(f.jsx)(i,{values:t,name:a,isModal:!0})}),Object(f.jsxs)("div",{className:"footer",children:[Object(f.jsx)("a",{href:"#!",onClick:o,children:n.cancel}),Object(f.jsx)("button",{type:"button",className:"btn btn-primary",onClick:d,children:n.search})]})]})})]},c)},r="Hide";function o(){r="Hide"}function d(e){var t=[];document.querySelectorAll(".chbox-mdl input").forEach((function(e){e.checked&&t.push({label:a,value:e.value})})),u(t)}function u(e){var t="";if(h.indexOf("&")>=0){for(var n=h.split("&"),c=0;c<n.length;c++)n[c].indexOf(encodeURIComponent(a)+"=")<0&&(t+="&"+n[c]);t=t.substring(1)}""!=t&&(h=t),e.map((function(e,t){var n=encodeURIComponent(a)+"="+encodeURIComponent(e.value);h+="&"+n})),h=h.replace("q=0","q="),h+=-1==h.indexOf("is_facet_search=")?"&is_facet_search=true":"",window.location.href="/search"+h}for(var h=window.location.search.replace(",","%2C")||"?",b=window.location.search.substring(1).split("&"),m=0;m<b.length;m++)b[m]=decodeURIComponent(b[m]);var p,j="id_"+a+"_checkbox_modal";window.addEventListener("resize",(function(){"Hide"!==r&&(p||(p=setTimeout((function(){p=0,window.location.hash="#"+j}),100)))}));var v=null==c?5:c;return Object(f.jsx)("div",{children:Object(f.jsxs)("div",{className:"chbox-container",children:[Object(f.jsx)(i,{values:t,name:a,isModal:!1,displayNumber:v,onChange:function(e){var t=[];document.querySelectorAll(".chbox-mdl input").forEach((function(n){(n.checked&&e.target.value!==n.value||e.target.checked&&e.target.value===n.value)&&t.push({label:a,value:n.value})})),u(t)}}),t.length>v&&Object(f.jsx)("a",{href:"#"+j,onClick:function(){r="Show",document.querySelectorAll(".chbox-mdl input").forEach((function(e){e.checked=-1!=b.indexOf(a+"="+e.value)}))},children:". . . See More"}),Object(f.jsx)(l,{values:t,name:a,modalId:j,displayNumber:c})]})})};for(var x=function(e){var t=e.item,a=e.nameshow,c=e.name,s=e.key,i=e.labels,l=e.isInitOpen,r=e.uiType,o=e.displayNumber,d=window.location.search.replace(",","%2C").indexOf(encodeURIComponent(c))>=0||l,u=Object(n.useState)(d),h=Object(b.a)(u,2),p=h[0],v=h[1];return Object(f.jsxs)("div",{className:"panel panel-default",children:[Object(f.jsxs)("div",{className:"panel-heading clearfix",children:[Object(f.jsx)("h3",{className:"panel-title pull-left",children:a}),Object(f.jsxs)("a",{className:"pull-right",onClick:function(){return v(!p)},children:[!p&&Object(f.jsx)("span",{children:Object(f.jsx)("i",{className:"glyphicon glyphicon-chevron-right"})}),p&&Object(f.jsx)("span",{children:Object(f.jsx)("i",{className:"glyphicon glyphicon-chevron-down"})})]})]}),Object(f.jsx)(m.a,{isOpen:p,children:Object(f.jsxs)("div",{className:"panel-body index-body",children:[null!=t&&"SelectBox"===r&&Object(f.jsx)(j,{values:t.buckets,name:c,labels:i}),null!=t&&"CheckboxList"===r&&Object(f.jsx)(O,{values:t.buckets,name:c,labels:i,displayNumber:o}),null!=t&&"RangeSlider"===r&&Object(f.jsx)(g,{value:t.buckets,name:c,labels:i})]})})]},s)},y={},k=document.getElementsByClassName("body-facet-search-label"),_=0;_<k.length;_++)y[k[_].id]=k[_].value;var C=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={is_enable:!1,list_title:{},list_facet:{},list_order:{},list_uiType:{},list_isOpen:{},list_displayNumber:{}},n.getTitleAndOrder=n.getTitleAndOrder.bind(Object(o.a)(n)),n.get_facet_search_list=n.get_facet_search_list.bind(Object(o.a)(n)),n.convertData=n.convertData.bind(Object(o.a)(n)),n}return Object(r.a)(a,[{key:"getTitleAndOrder",value:function(){var e=this,t={},a={},n={},c={},s={};Object(h.a)("/facet-search/get-title-and-order",{method:"POST"}).then((function(e){return e.json()})).then((function(i){i.status&&(t=i.data.titles,a=i.data.order,n=i.data.uiTypes,c=i.data.isOpens,s=i.data.displayNumbers),e.setState({list_title:t}),e.setState({list_order:a}),e.setState({list_uiType:n}),e.setState({list_isOpen:c}),e.setState({list_displayNumber:s}),e.setState({is_enable:!0})}))}},{key:"get_facet_search_list",value:function(){var e=this,t=new URLSearchParams(window.location.search),a=2==t.get("search_type")?"/api/index/":"/api/records/";Object(h.a)(a+"?"+t.toString()).then((function(e){return e.json()})).then((function(a){if(2==t.get("search_type")){var n=a&&a.aggregations&&a.aggregations.aggregations?a.aggregations.aggregations[0]:{};e.convertData(n)}else e.convertData(a&&a.aggregations?a.aggregations:{})}))}},{key:"convertData",value:function(e){var t={};e&&Object.keys(e).map((function(a,n){var c=e[a][a]?e[a][a]:e[a],s=c.key&&c.key.hasOwnProperty("buckets");if(s=c.hasOwnProperty("buckets")||s){if(t[a]=c[a]?c[a]:c,"Time Period(s)"!=a&&"Data Language"!=a&&"Access"!=a)for(var i=document.getElementById("lang-code"),l=i.options[i.selectedIndex].value,r=t[a],o=0;o<r.buckets.length;o++){var d=r.buckets[o];("en"==l&&(d.key.charCodeAt(0)>256||d.key.charCodeAt(d.key.length-1)>256)||"en"!=l&&d.key.charCodeAt(0)<256&&d.key.charCodeAt(d.key.length-1)<256)&&(t[a].buckets.splice(o,1),o--)}if("Access"==a)for(var u=t[a],h=0;h<u.buckets.length;h++){var b=u.buckets[h];(b.key.charCodeAt(0)>256||b.key.charCodeAt(b.key.length-1)>256)&&(t[a].buckets.splice(h,1),h--)}}})),this.setState({list_facet:t})}},{key:"componentDidMount",value:function(){this.getTitleAndOrder(),this.get_facet_search_list()}},{key:"render",value:function(){var e=this.state,t=e.is_enable,a=e.list_title,n=e.list_facet,c=e.list_order,s=e.list_uiType,i=e.list_isOpen,l=e.list_displayNumber;return Object(f.jsx)("div",{children:t&&Object(f.jsx)("div",{className:"facet-search break-word",children:Object.keys(c).map((function(e,t){var r=c[e],o=n[r],d=a[r],u=i[r],h=s[r],b=l[r];return Object(f.jsx)(x,{item:o,nameshow:d,name:r,labels:y,isInitOpen:u,uiType:h,displayNumber:b},t)}))})})}}]),a}(c.a.Component);i.a.render(Object(f.jsx)(c.a.StrictMode,{children:Object(f.jsx)(C,{})}),document.getElementById("app-facet-search"))},67:function(e,t,a){}},[[158,1,2]]]);
//# sourceMappingURL=main.1a2897a4.chunk.js.map