(this["webpackJsonpweko-facet-search"]=this["webpackJsonpweko-facet-search"]||[]).push([[0],{159:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),s=a(11),r=a.n(s),o=a(6),i=a(7),l=a(15),u=a(8),d=a(13),h=(a(20),a(21),a(38)),b=a(5),p=a(161),g=a(63),j=a(4);var f=function(e){var t=e.value,a=e.name,n=e.labels,c=window.location.search.replace(",","%2C")||"?",s=[],r=[];return t&&t.map((function(e,t){var o={label:"",value:""},i=encodeURIComponent(a)+"="+encodeURIComponent(e.key),l=c.indexOf(i+"&")>=0,u=c.endsWith(i);o.label=(n[e.key]||e.key)+"("+e.doc_count+")",o.value=e.key,r.push(o),(l||u)&&s.push(o)})),Object(j.jsx)("div",{children:Object(j.jsx)("div",{className:"select-container",children:Object(j.jsx)(g.a,{defaultValue:s,isMulti:!0,name:"Facet_Search",ontrolShouldRenderValue:!1,onChange:function(e){!function(e){var t="";if(c.indexOf("&")>=0){for(var n=c.split("&"),s=0;s<n.length;s++)n[s].indexOf(encodeURIComponent(a)+"=")<0&&(t+="&"+n[s]);t=t.substring(1)}""!=t&&(c=t),e.map((function(e,t){var n=encodeURIComponent(a)+"="+encodeURIComponent(e.value);c+="&"+n})),window.location.href="/search"+c}(e)},backspaceRemovesValue:!1,isClearable:!1,options:r,className:"basic-multi-select",classNamePrefix:"select"})})})},m=a(62);var v=function(e){var t,a,c=e.value,s=(e.name,e.labels),r={},o=[],i=window.location.search.replace(",","%2C")||"?";if(c&&c.map((function(e,t){var a;e.key.length>0&&(a=parseInt(e.key),o.push(a))})),o.length>1)for(a in o.sort(),t=100/(o.length-1),o)r[a*t]=o[a].toString();var l=Object(n.useState)(o[0]),u=Object(b.a)(l,2),d=u[0],h=u[1],p=Object(n.useState)(o[a]),g=Object(b.a)(p,2),f=g[0],v=g[1];return Object(j.jsxs)("div",{children:[Object(j.jsx)("div",{className:"col-sm-11",style:{paddingBottom:"20px"},children:Object(j.jsx)(m.a.Range,{min:0,marks:r,step:t,onChange:function(e){h(r[e[0]]),v(r[e[1]])},defaultValue:[0,100]})}),Object(j.jsxs)("div",{className:"form-group row",children:[Object(j.jsx)("div",{className:"col-sm-5",children:Object(j.jsx)("input",{type:"number",id:"input_head",className:"form-control",value:d,onChange:function(e){return h(e.target.value)}})}),Object(j.jsx)("div",{className:"col-sm-5",children:Object(j.jsx)("input",{type:"number",id:"input_tail",className:"form-control",value:f,onChange:function(e){return v(e.target.value)}})}),Object(j.jsx)("div",{className:"col-sm-2",children:Object(j.jsxs)("button",{type:"button",style:{marginLeft:"3px"},className:"btn btn-primary pull-right",onClick:function(){!function(){var e="";if(i.indexOf("&")>=0){var t=i.split("&");console.log(t);for(var a=0;a<t.length;a++)t[a].indexOf(encodeURIComponent("date_range1_from")+"=")<0&&t[a].indexOf(encodeURIComponent("date_range1_to")+"=")<0&&(e+="&"+t[a]);e=e.substring(1)}""!=e&&(i=e)}();var e=parseInt(d),t=parseInt(f),a="";e&&(a+="&"+encodeURIComponent("date_range1_from")+"="+encodeURIComponent(e)),t&&(a+="&"+encodeURIComponent("date_range1_to")+"="+encodeURIComponent(t)),a?(i+=a,window.location.href="/search"+i):alert("show error message.")},children:[" ",s.Goto]})})]})]})};function O(e){return"Temporal"===e}for(var k=function(e){var t=e.item,a=e.nameshow,c=e.name,s=e.key,r=e.labels,o=window.location.search.replace(",","%2C").indexOf(encodeURIComponent(c))>=0,i=Object(n.useState)(o),l=Object(b.a)(i,2),u=l[0],d=l[1];return Object(j.jsxs)("div",{className:"panel panel-default",children:[Object(j.jsxs)("div",{className:"panel-heading clearfix",children:[Object(j.jsx)("h3",{className:"panel-title pull-left",children:a}),Object(j.jsxs)("a",{className:"pull-right",onClick:function(){return d(!u)},children:[!u&&Object(j.jsx)("span",{children:Object(j.jsx)("i",{className:"glyphicon glyphicon-chevron-right"})}),u&&Object(j.jsx)("span",{children:Object(j.jsx)("i",{className:"glyphicon glyphicon-chevron-down"})})]})]}),Object(j.jsx)(p.a,{isOpen:u,children:Object(j.jsxs)("div",{className:"panel-body index-body",children:[!O(c)&&Object(j.jsx)(f,{value:t.buckets,name:c,labels:r}),O(c)&&Object(j.jsx)(v,{value:t.buckets,name:c,labels:r})]})})]},s)},y={},x=document.getElementsByClassName("body-facet-search-label"),_=0;_<x.length;_++)y[x[_].id]=x[_].value;var C=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={is_enable:!0,list_title:{},list_facet:{}},n.getTitle=n.getTitle.bind(Object(l.a)(n)),n.get_facet_search_list=n.get_facet_search_list.bind(Object(l.a)(n)),n.convertData=n.convertData.bind(Object(l.a)(n)),n.getUrlVars=n.getUrlVars.bind(Object(l.a)(n)),n}return Object(i.a)(a,[{key:"getTitle",value:function(){var e=this,t={};Object(h.a)("/facet-search/get-title-and-order",{method:"POST"}).then((function(e){return e.json()})).then((function(a){a.status&&(t=a.data.titles),e.setState({list_title:t})}))}},{key:"get_facet_search_list",value:function(){var e=this,t=window.location.search,a="/api/records/",n=this.getUrlVars();n.search_type&&"2"===String(n.search_type)&&(a="/api/index/"),Object(h.a)(a+t).then((function(e){return e.json()})).then((function(t){if(n.search_type&&"2"===String(n.search_type)){var a=t&&t.aggregations&&t.aggregations.path&&t.aggregations.path.buckets&&t.aggregations.path.buckets[0]?t.aggregations.path.buckets[0]:{};e.convertData(a&&a[0]?a[0]:{})}else e.convertData(t&&t.aggregations?t.aggregations:{})}))}},{key:"getUrlVars",value:function(){var e={};return window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(t,a,n){e[a]=n})),e}},{key:"convertData",value:function(e){var t={};e&&Object.keys(e).map((function(a,n){var c=e[a][a]?e[a][a]:e[a],s=c.key&&c.key.hasOwnProperty("buckets");if(s=c.hasOwnProperty("buckets")||s){if(t[a]=c[a]?c[a]:c,"Temporal"!=a&&"Data Language"!=a&&"Access"!=a)for(var r=document.getElementById("lang-code"),o=r.options[r.selectedIndex].value,i=t[a],l=0;l<i.buckets.length;l++){var u=i.buckets[l];("en"==o&&(u.key.charCodeAt(0)>256||u.key.charCodeAt(u.key.length-1)>256)||"en"!=o&&u.key.charCodeAt(0)<256&&u.key.charCodeAt(u.key.length-1)<256)&&delete t[a].buckets[l]}if("Access"==a)for(var d=t[a],h=0;h<d.buckets.length;h++){var b=d.buckets[h];(b.key.charCodeAt(0)>256||b.key.charCodeAt(b.key.length-1)>256)&&delete t[a].buckets[h]}}})),this.setState({list_facet:t})}},{key:"componentDidMount",value:function(){this.getTitle(),this.get_facet_search_list()}},{key:"render",value:function(){var e=this.state,t=e.is_enable,a=e.list_title,n=e.list_facet;return Object(j.jsx)("div",{children:t&&Object(j.jsx)("div",{className:"facet-search break-word",children:Object.keys(n).map((function(e,t){var c=n[e],s=a[e];return Object(j.jsx)(k,{item:c,nameshow:s,name:e,labels:y},t)}))})})}}]),a}(c.a.Component);r.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(C,{})}),document.getElementById("app-facet-search"))}},[[159,1,2]]]);
//# sourceMappingURL=main.962825ab.chunk.js.map