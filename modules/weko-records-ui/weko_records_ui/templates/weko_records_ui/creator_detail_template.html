{#
  Copyright (C) 2020 National Institute of Informatics.
  WEKO3 is free software; you can redistribute it and/or
  modify it under the terms of the MIT License; see LICENSE file for more
  details.
#}

{% macro output_creator_data(attribute_value_mlt) %}
    {%- set index = 0 -%}
    {%- for attribute_data in attribute_value_mlt -%}
        {%- set index = index + loop.index -%}
        {%- if 'name' in  attribute_data -%}
            <a class='creator-name' href="javascript:void(0)" data-toggle="popover-x" data-target="#creator{{index}}" data-placement="top top-left" data-toggle="popover">
                {%- for name in attribute_data['name'] -%}
                    {{ name }}<span> </span>
                {%- endfor -%}
            </a><br>
        {%- endif -%}
        <div id="creator{{index}}" class="popover popover-x popover-default">
            <div class="arrow"></div>
            <h1 class="popover-header popover-title"><strong><span class="close pull-right" data-dismiss="popover-x">&times;</span>
                {%- if 'name' in  attribute_data -%}
                    {%- for name in attribute_data['name'] -%}
                        {{ name }}<span> </span>
                    {%- endfor -%}
                {%- endif -%}
            </strong></h1>
            <div class="popover-body popover-content">
                {%- if 'nameIdentifiers' in  attribute_data and attribute_data['nameIdentifiers'][0]-%}
                    <p>
                        {%- for i in attribute_data['nameIdentifiers'] -%}
                            {%- if 'nameIdentifierScheme' in i -%}
                                {{i['nameIdentifierScheme']}}
                                <span> </span>
                            {%- endif -%}
                            {%- if 'nameIdentifier' in i -%}
                                <a href='{%- if "nameIdentifierURI" in i -%} {{i["nameIdentifierURI"]}} {%- endif -%}'>
                                    {{i['nameIdentifier']}}
                                </a>
                            {%- endif -%}
                            <br>
                        {%- endfor -%}
                    </p>
                {%- endif -%}
                {%- if 'order_lang' in  attribute_data -%}
                    <table class="table table-borderless">
                        <tbody>
                            {%- for order in attribute_data['order_lang'] -%}
                                {%- for key, value in order.items() -%}
                                    {%- if value -%}
                                        <tr>
                                            <th class='key' class='key_lang'>
                                                {%- if key == 'NoLanguage' -%}
                                                <span></span>
                                                {%- else -%}
                                                <span>{{key}}</span>
                                                {%- endif -%}
                                            </th>
                                            <td class='key_lang'><span class="test">
                                                {%- if 'creatorName' in value -%}
                                                    {{value['creatorName']}}<br>
                                                {%- else -%}
                                                        {%- if 'familyName' in value -%}
                                                            {{value['familyName']}}<span> </span>
                                                        {%- endif -%}
                                                        {%- if 'givenName' in value -%}
                                                            {{value['givenName']}}<br>
                                                        {%- endif -%}
                                                {%- endif -%}
                                                {%- if 'creatorAlternative' in value -%}
                                                    {{value['creatorAlternative']}}<br>
                                                {%- endif -%}
                                                {%- if 'affiliationNameIdentifierScheme' in value -%}
                                                    {{value['affiliationNameIdentifierScheme']}}<span> </span>
                                                {%- endif -%}
                                                {%- if 'affiliationName' in value -%}
                                                    {{value['affiliationName']}}<span> </span>
                                                {%- endif -%}
                                                {%- if 'affiliationNameIdentifier' in value -%}
                                                    <a href='{%- if "affiliationNameIdentifierURI" in value -%}{{value["affiliationNameIdentifierURI"]}}{%- else -%}{{"javascript:void(0)"}}{%- endif -%}'>
                                                        {{value['affiliationNameIdentifier']}}
                                                    </a>
                                                {%- endif -%}
                                            </span>
                                            </td>
                                        </tr>
                                    {%- endif -%}
                                {%- endfor -%}
                            {%- endfor -%}
                        </tbody>
                    </table>
                {%- endif -%}
                <a href='/search?creator={{ attribute_data.get("name")[0]}}'>{{_('Search repository')}}</a>
            </div>
        </div>
    {%- endfor -%}
{% endmacro %}
